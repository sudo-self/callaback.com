import { getComponentSizeValues } from "./helpers/content/size.js";
import { stringifyFactoryIconContent } from "./helpers/content/stringify.js";
import { stringifyIconViewBox } from "../svg/viewbox/value.js";
import { createFactoryImports } from "./helpers/imports/create.js";
import { generateCSSFilesForComponent } from "./helpers/css/generate.js";
import { factoryPropTemplate, stringifyFactoryProps } from "./helpers/props/stringify.js";
import { stringifyFactoryImports } from "./helpers/imports/stringify.js";
import { getGeneratedComponentTypesFilename } from "./helpers/filenames/types.js";

/**
* Create raw component code
*/
function createRawComponent(data, options) {
	const assets = [];
	const imports = createFactoryImports();
	const codeLines = [];
	const style = generateCSSFilesForComponent(data.icon, imports, assets, options);
	const isEmbeddedCSS = options.cssMode === "embed";
	const props = {
		xmlns: "http://www.w3.org/2000/svg",
		...getComponentSizeValues(options, data.viewBox),
		viewBox: stringifyIconViewBox(data.viewBox)
	};
	const icon = {
		...data.icon,
		content: `<svg ${stringifyFactoryProps(props, factoryPropTemplate)}>${isEmbeddedCSS && style ? `<style>${style}</style>` : ""}${data.icon.content}</svg>`
	};
	codeLines.push(`const icon = ${stringifyFactoryIconContent(icon, options)};\n`);
	codeLines.push("export default icon;\n");
	const importsCode = stringifyFactoryImports(imports);
	if (importsCode) codeLines.unshift(importsCode);
	const typesContent = `const icon: string;\nexport default icon;\n`;
	assets.push({
		...getGeneratedComponentTypesFilename(data, typesContent, options),
		content: typesContent
	});
	return {
		assets,
		content: codeLines.join("\n"),
		style: isEmbeddedCSS ? void 0 : style
	};
}

export { createRawComponent };