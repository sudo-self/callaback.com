import{f as j,e as z,a as A,s as L}from"../chunks/kngTHrYm.js";import{i as B}from"../chunks/DS1rcICQ.js";import{o as F}from"../chunks/QMVcuV15.js";import{al as G,aj as K,u as S,r as Q,h as R,J as p,am as U,a7 as X,ag as N,ah as Y,a9 as x,g as a,aa as Z,ab as b,ac as u,s as l,m as h,ad as _}from"../chunks/DhHtmFCV.js";import{i as ee}from"../chunks/BKlt1PlW.js";import{e as ae,i as te,r as se}from"../chunks/BtudUlw-.js";import{t as re,b as oe}from"../chunks/DMzgk5bG.js";import{s as O}from"../chunks/D_QdJmzw.js";import{b as le}from"../chunks/B8b7qpMz.js";import{s as ne,a as ie}from"../chunks/7E810DOH.js";import{t as ce}from"../chunks/2iP4mYBg.js";function ve(e,n,m=n){var g=new WeakSet;G(e,"input",async v=>{var t=v?e.defaultValue:e.value;if(t=M(e)?T(t):t,m(t),p!==null&&g.add(p),await K(),t!==(t=n())){var c=e.selectionStart,s=e.selectionEnd,f=e.value.length;if(e.value=t??"",s!==null){var i=e.value.length;c===s&&s===f&&i>f?(e.selectionStart=i,e.selectionEnd=i):(e.selectionStart=c,e.selectionEnd=Math.min(s,i))}}}),(R&&e.defaultValue!==e.value||S(n)==null&&e.value)&&(m(M(e)?T(e.value):e.value),p!==null&&g.add(p)),Q(()=>{var v=n();if(e===document.activeElement){var t=U??p;if(g.has(t))return}M(e)&&v===T(e.value)||e.type==="date"&&!v&&!e.value||v!==e.value&&(e.value=v??"")})}function M(e){var n=e.type;return n==="number"||n==="range"}function T(e){return e===""?null:+e}function fe(e){return function(...n){var m=n[0];return m.preventDefault(),e?.apply(this,n)}}var de=j("<div> </div>"),me=j('<div class="message assistant typing svelte-o39feg"> </div>'),ue=j('<section><header class="chat-header svelte-o39feg"><h1 class="svelte-o39feg"><span class="brand-gradient svelte-o39feg">ai.callaback</span></h1> <p class="subtitle svelte-o39feg">Talk to the Callaback assistant</p></header> <div class="chat-shell svelte-o39feg"><div class="chat-messages svelte-o39feg"><!> <!> <div></div></div> <form class="chat-input svelte-o39feg"><input placeholder="Ask somethingâ€¦" autocomplete="off" class="svelte-o39feg"/> <button class="svelte-o39feg">Send</button></form></div></section>');function Ee(e,n){X(n,!1);const m=()=>ie(ce,"$theme",g),[g,v]=ne();let t=h([]),c=h(""),s=h(!1),f=h(),i=h(""),k=h();F(()=>{l(t,[{role:"assistant",content:"ðŸ“ž Hi! Iâ€™m callaback AI. Ask me anything."}]),m()==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")});async function W(){if(!a(c).trim()||a(s))return;const r=a(c);l(c,""),l(s,!0),l(t,[...a(t),{role:"user",content:r}]);try{const o=await fetch("https://llm.callaback1900.workers.dev",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r})});if(!o.ok)throw new Error("Worker error: "+o.status);const E=(await o.json())?.response?.response||"No response from AI.";l(t,[...a(t),{role:"assistant",content:E}])}catch(o){console.error("AI fetch error:",o),l(t,[...a(t),{role:"assistant",content:"âš ï¸ Something went wrong talking to the AI."}])}finally{l(s,!1)}}N(()=>a(f),()=>{a(f)&&a(f).scrollIntoView({behavior:"smooth"})}),N(()=>(a(s),a(i),a(k)),()=>{a(s)?(l(i,""),clearInterval(a(k)),l(k,setInterval(()=>{l(i,a(i).length<3?a(i)+".":"")},400))):(clearInterval(a(k)),l(i,""))}),Y(),B();var y=ue();let D;var V=b(u(y),2),$=u(V),C=u($);ae(C,1,()=>a(t),te,(r,o)=>{var d=de(),E=u(d,!0);_(d),x(()=>{O(d,1,`message ${a(o),S(()=>a(o).role)??""}`,"svelte-o39feg"),L(E,(a(o),S(()=>a(o).content)))}),re(1,d,()=>oe,()=>({y:8,opacity:0,duration:180})),A(r,d)});var J=b(C,2);{var H=r=>{var o=me(),d=u(o);_(o),x(()=>L(d,`Thinking${a(i)??""}`)),A(r,o)};ee(J,r=>{a(s)&&r(H)})}var P=b(J,2);le(P,r=>l(f,r),()=>a(f)),_($);var w=b($,2),I=u(w);se(I);var q=b(I,2);_(w),_(V),_(y),x(r=>{D=O(y,1,"chat-page svelte-o39feg",null,D,{dark:m()==="dark"}),I.disabled=a(s),q.disabled=r},[()=>(a(s),a(c),S(()=>a(s)||!a(c).trim()))]),ve(I,()=>a(c),r=>l(c,r)),z("submit",w,fe(W)),A(e,y),Z(),v()}export{Ee as component};
