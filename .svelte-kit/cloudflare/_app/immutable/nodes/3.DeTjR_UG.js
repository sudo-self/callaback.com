import{f as T,e as z,a as A,s as J}from"../chunks/kngTHrYm.js";import{i as B}from"../chunks/DS1rcICQ.js";import{o as F}from"../chunks/QMVcuV15.js";import{al as G,aj as K,u as q,r as Q,h as R,J as b,am as U,a7 as X,ag as L,ah as Y,a9 as E,g as a,aa as Z,ab as y,ac as u,s as l,m as h,ad as p}from"../chunks/DhHtmFCV.js";import{i as ee}from"../chunks/BKlt1PlW.js";import{e as ae,i as se,r as te}from"../chunks/BtudUlw-.js";import{t as re,b as le}from"../chunks/DMzgk5bG.js";import{s as N}from"../chunks/D_QdJmzw.js";import{b as oe}from"../chunks/B8b7qpMz.js";import{s as ne,a as ie}from"../chunks/7E810DOH.js";import{t as ce}from"../chunks/2iP4mYBg.js";function ve(e,o,m=o){var _=new WeakSet;G(e,"input",async d=>{var s=d?e.defaultValue:e.value;if(s=x(e)?M(s):s,m(s),b!==null&&_.add(b),await K(),s!==(s=o())){var v=e.selectionStart,t=e.selectionEnd,f=e.value.length;if(e.value=s??"",t!==null){var n=e.value.length;v===t&&t===f&&n>f?(e.selectionStart=n,e.selectionEnd=n):(e.selectionStart=v,e.selectionEnd=Math.min(t,n))}}}),(R&&e.defaultValue!==e.value||q(o)==null&&e.value)&&(m(x(e)?M(e.value):e.value),b!==null&&_.add(b)),Q(()=>{var d=o();if(e===document.activeElement){var s=U??b;if(_.has(s))return}x(e)&&d===M(e.value)||e.type==="date"&&!d&&!e.value||d!==e.value&&(e.value=d??"")})}function x(e){var o=e.type;return o==="number"||o==="range"}function M(e){return e===""?null:+e}function de(e){return function(...o){var m=o[0];return m.preventDefault(),e?.apply(this,o)}}var fe=T("<div> </div>"),me=T('<div class="message assistant typing svelte-cwls5q"> </div>'),ue=T('<section><header class="chat-header svelte-cwls5q"><h1 class="svelte-cwls5q"><span class="brand-gradient svelte-cwls5q">callaback</span><span class="domain svelte-cwls5q">.ai</span></h1> <p class="subtitle svelte-cwls5q">Talk to the Callaback assistant</p></header> <div class="chat-shell svelte-cwls5q"><div class="chat-messages svelte-cwls5q"><!> <!> <div></div></div> <form class="chat-input svelte-cwls5q"><input placeholder="Ask somethingâ€¦" autocomplete="off" class="input-field svelte-cwls5q"/> <button class="svelte-cwls5q">Send</button></form></div></section>');function $e(e,o){X(o,!1);const m=()=>ie(ce,"$theme",_),[_,d]=ne();let s=h([]),v=h(""),t=h(!1),f=h(),n=h(""),g=h();F(()=>{l(s,[{role:"assistant",content:"Hi ðŸ‘‹ Iâ€™m callaback AI. Ask me anything."}]),m()==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")});async function O(){if(!a(v).trim()||a(t))return;const r=a(v);l(v,""),l(t,!0),l(s,[...a(s),{role:"user",content:r}]);try{const i=await fetch("https://ai.callaback1900.workers.dev",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r})});if(!i.ok)throw new Error("Worker error");const c=await i.json(),$=Array.isArray(c)&&c[0]?.response?.response?c[0].response.response:"No response from AI.";l(s,[...a(s),{role:"assistant",content:$}])}catch{l(s,[...a(s),{role:"assistant",content:"âš ï¸ Something went wrong talking to the AI."}])}finally{l(t,!1)}}L(()=>a(f),()=>{a(f)&&a(f).scrollIntoView({behavior:"smooth"})}),L(()=>(a(t),a(n),a(g)),()=>{a(t)?(l(n,""),clearInterval(a(g)),l(g,setInterval(()=>{l(n,a(n).length<3?a(n)+".":"")},400))):(clearInterval(a(g)),l(n,""))}),Y(),B();var k=ue();let j;var D=y(u(k),2),I=u(D),V=u(I);ae(V,1,()=>a(s),se,(r,i)=>{var c=fe(),$=u(c,!0);p(c),E(()=>{N(c,1,`message ${a(i),q(()=>a(i).role)??""}`,"svelte-cwls5q"),J($,(a(i),q(()=>a(i).content)))}),re(1,c,()=>le,()=>({y:8,opacity:0,duration:180})),A(r,c)});var C=y(V,2);{var W=r=>{var i=me(),c=u(i);p(i),E(()=>J(c,`Thinking${a(n)??""}`)),A(r,i)};ee(C,r=>{a(t)&&r(W)})}var H=y(C,2);oe(H,r=>l(f,r),()=>a(f)),p(I);var S=y(I,2),w=u(S);te(w);var P=y(w,2);p(S),p(D),p(k),E(r=>{j=N(k,1,"chat-page svelte-cwls5q",null,j,{dark:m()==="dark"}),w.disabled=a(t),P.disabled=r},[()=>(a(t),a(v),q(()=>a(t)||!a(v).trim()))]),ve(w,()=>a(v),r=>l(v,r)),z("submit",S,de(O)),A(e,k),Z(),d()}export{$e as component};
